OBJECT=MUSIC
MUSIC:TYPE=MUSIC
MUSIC:FILENAME=GABINETY.WAV

OBJECT=VARITEMP0
VARITEMP0:TYPE=INTEGER

OBJECT=VARITEMP1
VARITEMP1:TYPE=INTEGER

OBJECT=VARITEMP2
VARITEMP2:TYPE=INTEGER

OBJECT=VARSTEMP0
VARSTEMP0:TYPE=STRING

OBJECT=VARSTEMP1
VARSTEMP1:TYPE=STRING

OBJECT=VARSTEMP2
VARSTEMP2:TYPE=STRING

OBJECT=VARSREXQUE
VARSREXQUE:TYPE=STRING

OBJECT=VARSCHARACTERHISTORY
VARSCHARACTERHISTORY:TYPE=STRING

OBJECT=VARSCHARACTERANSWERS
VARSCHARACTERANSWERS:TYPE=STRING

OBJECT=VARSFOCUS
VARSFOCUS:TYPE=STRING
VARSFOCUS:VALUE=NULL

OBJECT=VARIMODE
VARIMODE:TYPE=INTEGER

OBJECT=VARIFOCUSIDX
VARIFOCUSIDX:TYPE=INTEGER

OBJECT=VARSCURRID
VARSCURRID:TYPE=STRING

OBJECT=VARSRETURN
VARSRETURN:TYPE=INTEGER

OBJECT=VARICHARACTERINDEX
VARICHARACTERINDEX:TYPE=INTEGER

OBJECT=ANNEXIT
ANNEXIT:TYPE=ANIMO
ANNEXIT:VISIBLE=TRUE
ANNEXIT:FILENAME=POWROT.ANN
ANNEXIT:TOCANVAS=TRUE
ANNEXIT:PRIORITY=0
ANNEXIT:FPS=16
ANNEXIT:PRELOAD=TRUE
ANNEXIT:RELEASE=TRUE
ANNEXIT:MONITORCOLLISION=FALSE
ANNEXIT:MONITORCOLLISIONALPHA=FALSE
ANNEXIT:ONCLICK={BEHSAVE^RUN();__SCREENSHOT__^RUN();BEHRETURN^RUN();}
ANNEXIT:ONFOCUSOFF={ANNEXIT^PLAY("ONNOEVENT");}

OBJECT=ANNCHARACTER
ANNCHARACTER:TYPE=ANIMO
ANNCHARACTER:VISIBLE=TRUE
ANNCHARACTER:FILENAME=BUREKTOR.ANN
ANNCHARACTER:TOCANVAS=TRUE
ANNCHARACTER:PRIORITY=9
ANNCHARACTER:FPS=16
ANNCHARACTER:PRELOAD=TRUE
ANNCHARACTER:RELEASE=TRUE
ANNCHARACTER:MONITORCOLLISION=FALSE
ANNCHARACTER:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNSMOKE
ANNSMOKE:TYPE=ANIMO
ANNSMOKE:VISIBLE=TRUE
ANNSMOKE:FILENAME=DYMKI_KOLOROWE.ANN
ANNSMOKE:TOCANVAS=TRUE
ANNSMOKE:PRIORITY=15
ANNSMOKE:FPS=16
ANNSMOKE:PRELOAD=TRUE
ANNSMOKE:RELEASE=TRUE
ANNSMOKE:MONITORCOLLISION=FALSE
ANNSMOKE:MONITORCOLLISIONALPHA=FALSE

OBJECT=ANNHISTORY
ANNHISTORY:TYPE=ANIMO
ANNHISTORY:VISIBLE=TRUE
ANNHISTORY:FILENAME=HISTORIA.ANN
ANNHISTORY:TOCANVAS=TRUE
ANNHISTORY:PRIORITY=20
ANNHISTORY:FPS=16
ANNHISTORY:PRELOAD=TRUE
ANNHISTORY:RELEASE=TRUE
ANNHISTORY:MONITORCOLLISION=FALSE
ANNHISTORY:MONITORCOLLISIONALPHA=FALSE
ANNHISTORY:ONCLICK={@IF(SEQBLANK^ISPLAYING(),"_","TRUE","BFITMP0","");@IF("SNDREX0^ISPLAYING()'TRUE||SNDREX1^ISPLAYING()'TRUE||SNDREX2^ISPLAYING()'TRUE","BFITMP1","");@IF("SNDREX3^ISPLAYING()'TRUE||SNDREX4^ISPLAYING()'TRUE||SNDREX5^ISPLAYING()'TRUE","BFITMP2","");BEHHIDEALL^RUN();@IF("VARIMODE","_","0","BFITMP3","BFITMP4");}
ANNHISTORY:ONFOCUSOFF={ANNHISTORY^PLAY("ONNOEVENT");}
ANNHISTORY:ONFOCUSON={@IF("SNDANSWER^ISPLAYING()'TRUE||SEQBLANK^ISPLAYING()'TRUE","BFITMP25","");@IF("SNDREX0^ISPLAYING()'TRUE||SNDREX1^ISPLAYING()'TRUE||SNDREX2^ISPLAYING()'TRUE","BFITMP26","");@IF("SNDREX3^ISPLAYING()'TRUE||SNDREX4^ISPLAYING()'TRUE||SNDREX5^ISPLAYING()'TRUE","BFITMP27","");@IF("VARIMODE","_","0","{SNDQUESTION^STOP(FALSE);SNDHISTORYENTER^PLAY();}","{SNDQUESTION^STOP(FALSE);SNDHISTORYRETURN^PLAY();}");}

OBJECT=ANNSMOKEHIST
ANNSMOKEHIST:TYPE=ANIMO
ANNSMOKEHIST:VISIBLE=TRUE
ANNSMOKEHIST:FILENAME=DYMEK_HISTORIA.ANN
ANNSMOKEHIST:TOCANVAS=TRUE
ANNSMOKEHIST:PRIORITY=15
ANNSMOKEHIST:FPS=16
ANNSMOKEHIST:PRELOAD=TRUE
ANNSMOKEHIST:RELEASE=TRUE
ANNSMOKEHIST:MONITORCOLLISION=FALSE
ANNSMOKEHIST:MONITORCOLLISIONALPHA=FALSE

OBJECT=IMGTLO
IMGTLO:TYPE=IMAGE
IMGTLO:VISIBLE=TRUE
IMGTLO:FILENAME=BUREKTOR_TLO.IMG
IMGTLO:TOCANVAS=TRUE
IMGTLO:PRIORITY=0
IMGTLO:PRELOAD=TRUE
IMGTLO:RELEASE=TRUE
IMGTLO:MONITORCOLLISION=FALSE
IMGTLO:MONITORCOLLISIONALPHA=FALSE

OBJECT=SEQBLANK
SEQBLANK:TYPE=SEQUENCE
SEQBLANK:FILENAME=BLANK.SEQ
SEQBLANK:ONFINISHED^GADABLANK={@IF(ARRSEQ^GETSIZE(),">","0","BFITMP13","BFITMP14");}

OBJECT=SNDQUESTION
SNDQUESTION:TYPE=SOUND
SNDQUESTION:FILENAME=BUREKTOR_M030.WAV
SNDQUESTION:PRELOAD=FALSE
SNDQUESTION:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDANSWER
SNDANSWER:TYPE=SOUND
SNDANSWER:FILENAME=BUREKTOR_M029.WAV
SNDANSWER:PRELOAD=FALSE
SNDANSWER:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDREX0
SNDREX0:TYPE=SOUND
SNDREX0:FILENAME=REX_R008.WAV
SNDREX0:PRELOAD=FALSE
SNDREX0:FLUSHAFTERPLAYED=FALSE
SNDREX0:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDREX1
SNDREX1:TYPE=SOUND
SNDREX1:FILENAME=REX_R009.WAV
SNDREX1:PRELOAD=FALSE
SNDREX1:FLUSHAFTERPLAYED=FALSE
SNDREX1:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDREX2
SNDREX2:TYPE=SOUND
SNDREX2:FILENAME=REX_R011.WAV
SNDREX2:PRELOAD=FALSE
SNDREX2:FLUSHAFTERPLAYED=FALSE
SNDREX2:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDREX3
SNDREX3:TYPE=SOUND
SNDREX3:FILENAME=REX_R013.WAV
SNDREX3:PRELOAD=FALSE
SNDREX3:FLUSHAFTERPLAYED=FALSE
SNDREX3:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDREX4
SNDREX4:TYPE=SOUND
SNDREX4:FILENAME=REX_R014.WAV
SNDREX4:PRELOAD=FALSE
SNDREX4:FLUSHAFTERPLAYED=FALSE
SNDREX4:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDREX5
SNDREX5:TYPE=SOUND
SNDREX5:FILENAME=REX_R015.WAV
SNDREX5:PRELOAD=FALSE
SNDREX5:FLUSHAFTERPLAYED=FALSE
SNDREX5:ONFINISHED={SEQBLANK^PLAY("GADABLANK");}

OBJECT=SNDKRET0
SNDKRET0:TYPE=SOUND
SNDKRET0:FILENAME=KRETES_M080.WAV
SNDKRET0:PRELOAD=FALSE
SNDKRET0:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET1
SNDKRET1:TYPE=SOUND
SNDKRET1:FILENAME=KRETES_M081.WAV
SNDKRET1:PRELOAD=FALSE
SNDKRET1:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET2
SNDKRET2:TYPE=SOUND
SNDKRET2:FILENAME=KRETES_M082.WAV
SNDKRET2:PRELOAD=FALSE
SNDKRET2:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET3
SNDKRET3:TYPE=SOUND
SNDKRET3:FILENAME=KRETES_M083.WAV
SNDKRET3:PRELOAD=FALSE
SNDKRET3:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET4
SNDKRET4:TYPE=SOUND
SNDKRET4:FILENAME=KRETES_M084.WAV
SNDKRET4:PRELOAD=FALSE
SNDKRET4:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET5
SNDKRET5:TYPE=SOUND
SNDKRET5:FILENAME=KRETES_M085.WAV
SNDKRET5:PRELOAD=FALSE
SNDKRET5:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET6
SNDKRET6:TYPE=SOUND
SNDKRET6:FILENAME=KRETES_M086.WAV
SNDKRET6:PRELOAD=FALSE
SNDKRET6:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET7
SNDKRET7:TYPE=SOUND
SNDKRET7:FILENAME=KRETES_M087.WAV
SNDKRET7:PRELOAD=FALSE
SNDKRET7:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET8
SNDKRET8:TYPE=SOUND
SNDKRET8:FILENAME=KRETES_M088.WAV
SNDKRET8:PRELOAD=FALSE
SNDKRET8:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDKRET9
SNDKRET9:TYPE=SOUND
SNDKRET9:FILENAME=KRETES_M089.WAV
SNDKRET9:PRELOAD=FALSE
SNDKRET9:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDHISTORYENTER
SNDHISTORYENTER:TYPE=SOUND
SNDHISTORYENTER:FILENAME=KOGUT_M093.WAV
SNDHISTORYENTER:PRELOAD=FALSE
SNDHISTORYENTER:FLUSHAFTERPLAYED=FALSE

OBJECT=SNDHISTORYRETURN
SNDHISTORYRETURN:TYPE=SOUND
SNDHISTORYRETURN:FILENAME=KOGUT_M092.WAV
SNDHISTORYRETURN:PRELOAD=FALSE
SNDHISTORYRETURN:FLUSHAFTERPLAYED=FALSE

OBJECT=ARRQUESTIONS
ARRQUESTIONS:TYPE=ARRAY

OBJECT=ARRANSWERS
ARRANSWERS:TYPE=ARRAY

OBJECT=ARRSEQ
ARRSEQ:TYPE=ARRAY

OBJECT=ARRBASEQUESTIONS
ARRBASEQUESTIONS:TYPE=ARRAY

OBJECT=ARRHISTORY
ARRHISTORY:TYPE=ARRAY

OBJECT=ARRCOLORS
ARRCOLORS:TYPE=ARRAY

OBJECT=ARRASKED
ARRASKED:TYPE=ARRAY

OBJECT=ARRWIZARDS
ARRWIZARDS:TYPE=ARRAY

OBJECT=ARRTOREMOVE
ARRTOREMOVE:TYPE=ARRAY

OBJECT=ARRTOADD
ARRTOADD:TYPE=ARRAY

OBJECT=ARRTOHISTORY
ARRTOHISTORY:TYPE=ARRAY

OBJECT=ARRTOASKED
ARRTOASKED:TYPE=ARRAY

OBJECT=ARRTOTRIGGER
ARRTOTRIGGER:TYPE=ARRAY

OBJECT=MOUSE
MOUSE:TYPE=MOUSE
MOUSE:RAW=
MOUSE:ONCLICK^LEFT={@IF("SNDANSWER^ISPLAYING()'TRUE||SEQBLANK^ISPLAYING()'TRUE","BFITMP15","");@IF("SNDREX0^ISPLAYING()'TRUE||SNDREX1^ISPLAYING()'TRUE||SNDREX2^ISPLAYING()'TRUE","BFITMP16","");@IF("SNDREX3^ISPLAYING()'TRUE||SNDREX4^ISPLAYING()'TRUE||SNDREX5^ISPLAYING()'TRUE","BFITMP17","");VARSTEMP0^SET(CANVASOBSERVER^GETGRAPHICSAT(MOUSE^GETPOSX(),MOUSE^GETPOSY(),TRUE,15,15,TRUE));@IF(VARSTEMP0^FIND("SMOKE"),">","-1","BFITMP24","");}
MOUSE:ONMOVE={@IF("SNDANSWER^ISPLAYING()'TRUE||SEQBLANK^ISPLAYING()'TRUE","BFITMP25","");@IF("SNDREX0^ISPLAYING()'TRUE||SNDREX1^ISPLAYING()'TRUE||SNDREX2^ISPLAYING()'TRUE","BFITMP26","");@IF("SNDREX3^ISPLAYING()'TRUE||SNDREX4^ISPLAYING()'TRUE||SNDREX5^ISPLAYING()'TRUE","BFITMP27","");BEHMMOVE^RUN();}

OBJECT=CNVLOADER
CNVLOADER:TYPE=CNVLOADER

OBJECT=CANVASOBSERVER
CANVASOBSERVER:TYPE=CANVAS_OBSERVER

OBJECT=SDIALOG
SDIALOG:TYPE=STRUCT
SDIALOG:FIELDS=ID<STRING>,QUE<STRING>,ANS<STRING>,TRIG<STRING>

OBJECT=DBDIALOG
DBDIALOG:TYPE=DATABASE
DBDIALOG:MODEL=SDIALOG

OBJECT=KEYBOARD
KEYBOARD:TYPE=KEYBOARD

OBJECT=__INIT__
__INIT__:TYPE=BEHAVIOUR
__INIT__:CODE={SCENENAME^SET("DIALOGS");G_CURSOR^SETSCENE("DIALOGS");G_AMBIENT^SETAMBIENT("DIALOGS");G_CARD^SETSCENE("DIALOGS");__FLIP__^RUN();G_ANNPAGE^PLAY("PLAY");ARRWIZARDS^ADD("BUREKTOR","GULDRYK","SNEJK","WALDIMORS","SPIELMAUSTER","CHRUMBURAK","BARANDALF");VARICHARACTERINDEX^SET(ARRWIZARDS^FIND(G_SDIALOGCHARACTER));G_SDIALOGRETURN^SET(G_SLASTOBJECTS);G_SARCADEOBJECTS^SET("DIALOGS");G_MENU^SETSCENE("DIALOGS");G_MENU^SAVESETS();@IF("G_SDIALOGCHARACTER","_",""GASIENICA"","BFITMP28","BFITMP29");ANNEXIT^SETASBUTTON(TRUE,TRUE);VARSTEMP0^SET([G_SDIALOGCHARACTER+".ANN"]);ANNCHARACTER^LOAD(VARSTEMP0);VARSTEMP0^SET([G_SDIALOGCHARACTER+"_TLO.IMG"]);IMGTLO^LOAD(VARSTEMP0);ANNSMOKE^CLONE(23);ANNSMOKEHIST^CLONE(23);BEHHIDEALL^RUN();DBDIALOG^LOAD("$COMMON\DIALOGS.DTA");VARSCHARACTERHISTORY^SET(["$COMMON\"+G_SDIALOGCHARACTER+"_HIST0.ARR"]);ARRHISTORY^LOAD(VARSCHARACTERHISTORY);VARSCHARACTERANSWERS^SET(["$COMMON\"+G_SDIALOGCHARACTER+".ARR"]);ARRANSWERS^LOAD(VARSCHARACTERANSWERS);VARSREXQUE^SET("$COMMON\QUESTIONS0.ARR");ARRBASEQUESTIONS^LOAD(VARSREXQUE);ARRASKED^LOAD("$COMMON\QUESTIONS_ASKED0.ARR");BEHFIXQUESTIONS^RUN();BEHBUILDQUESTIONS^RUN();BEHMAKESMOKES^RUN();DIALOGS^STARTMUSIC("GABINETY.WAV");DIALOGS^SETMUSICVOLUME([0.8*G_ARRSETTINGS^GET(1)]);}


OBJECT=BEHADDTRIGGERED
BEHADDTRIGGERED:TYPE=BEHAVIOUR
BEHADDTRIGGERED:CODE={@IF("VARSTEMP0","!_",""NULL"","BFITMP34","");}


OBJECT=BEHBUILDQUESTIONS
BEHBUILDQUESTIONS:TYPE=BEHAVIOUR
BEHBUILDQUESTIONS:CODE={ARRQUESTIONS^REMOVEALL();@LOOP("{VARITEMP0^SET(_I_);@IF(ARRANSWERS^FIND(ARRBASEQUESTIONS^GET(VARITEMP0)),">","-1","BFITMP35","");}",0,ARRBASEQUESTIONS^GETSIZE(),1);}


OBJECT=BEHASK
BEHASK:TYPE=BEHAVIOUR
BEHASK:CODE={VARITEMP0^SET($1);@IF(DBDIALOG^FIND("ID",ARRQUESTIONS^GET(VARITEMP0),0),"_","-1","BFITMP36","");SDIALOG^SET("DBDIALOG_CURSOR");VARSCURRID^SET(SDIALOG|ID);@IF("VARSCURRID","_",""96"","BFITMP41","");@IF("VARSCURRID","_",""104"","BFITMP46","");VARITEMP1^SET(ARRBASEQUESTIONS^FIND(SDIALOG|ID));@IF("VARSCURRID","!_",""43B"","BFITMP48","");BEHFILLSEQ^RUN(SDIALOG|ANS);SNDANSWER^LOAD(ARRSEQ^GET(0));ARRSEQ^REMOVEAT(0);BEHBUILDQUESTIONS^RUN();BEHMAKESMOKES^RUN();VARSTEMP0^SET(SDIALOG|TRIG);BEHADDTRIGGERED^RUN();BEHFIXQUESTIONS^RUN();BEHBUILDQUESTIONS^RUN();BEHSAVE^RUN();SNDQUESTION^STOP(FALSE);VARITEMP0^SET(RANDOM^GET(0,6));VARSTEMP0^SET(["SNDREX"+VARITEMP0]);*VARSTEMP0^PLAY();}


OBJECT=BEHASKHISTORY
BEHASKHISTORY:TYPE=BEHAVIOUR
BEHASKHISTORY:CODE={VARITEMP0^SET($1);@IF(DBDIALOG^FIND("ID",ARRHISTORY^GET(VARITEMP0),0),"_","-1","BFITMP49","");SDIALOG^SET("DBDIALOG_CURSOR");BEHFILLSEQ^RUN(SDIALOG|ANS);SNDANSWER^LOAD(ARRSEQ^GET(0));ARRSEQ^REMOVEAT(0);SNDQUESTION^STOP(FALSE);VARITEMP0^SET(RANDOM^GET(0,6));VARSTEMP0^SET(["SNDREX"+VARITEMP0]);*VARSTEMP0^PLAY();}


OBJECT=BEHFILLSEQ
BEHFILLSEQ:TYPE=BEHAVIOUR
BEHFILLSEQ:CODE={VARSTEMP0^SET($1);@IF("VARSTEMP0","_",""NULL"","BFITMP50","");ARRSEQ^REMOVEALL();VARITEMP1^SET(VARSTEMP0^LENGTH());@WHILE("VARITEMP1",">","0","{VARITEMP0^SET(VARSTEMP0^FIND(".WAV"));@IF("VARITEMP0","_","-1","BFITMP55","BFITMP56");}");}


OBJECT=BEHMAKESMOKES
BEHMAKESMOKES:TYPE=BEHAVIOUR
BEHMAKESMOKES:CODE={@LOOP("{VARSTEMP0^SET(["ANNSMOKE_"+_I_]);*VARSTEMP0^HIDE();*VARSTEMP0^SETPOSITION(0,0);}",0,24,1);VARITEMP0^SET(0);VARITEMP1^SET(0);ARRCOLORS^REMOVEALL();VARITEMP2^SET(ARRQUESTIONS^GETSIZE());VARITEMP2^CLAMP(0,24);@LOOP("{VARITEMP2^SET(DBDIALOG^FIND("ID",ARRQUESTIONS^GET(_I_),0));VARITEMP2^MOD(6);VARITEMP2^INC();VARSTEMP2^SET(["PLAY"+VARITEMP2]);ARRCOLORS^ADD(VARITEMP2);VARSTEMP0^SET(["ANNSMOKE_"+_I_]);*VARSTEMP0^MOVE([VARITEMP0*88],[VARITEMP1*80]);*VARSTEMP0^PLAY(VARSTEMP2);*VARSTEMP0^SHOW();VARITEMP0^INC();@IF("VARITEMP0","_","4","BFITMP57","");}",0,VARITEMP2,1);}


OBJECT=BEHMAKESMOKESHIST
BEHMAKESMOKESHIST:TYPE=BEHAVIOUR
BEHMAKESMOKESHIST:CODE={@LOOP("{VARSTEMP0^SET(["ANNSMOKEHIST_"+_I_]);*VARSTEMP0^HIDE();*VARSTEMP0^SETPOSITION(0,0);}",0,24,1);VARITEMP0^SET(0);VARITEMP1^SET(0);VARITEMP2^SET(ARRHISTORY^GETSIZE());VARITEMP2^CLAMP(0,24);@LOOP("{VARSTEMP0^SET(["ANNSMOKEHIST_"+_I_]);*VARSTEMP0^MOVE([VARITEMP0*88],[VARITEMP1*80]);*VARSTEMP0^SHOW();VARITEMP0^INC();@IF("VARITEMP0","_","4","BFITMP58","");}",0,VARITEMP2,1);}


OBJECT=BEHSPEAKQUESTION
BEHSPEAKQUESTION:TYPE=BEHAVIOUR
BEHSPEAKQUESTION:CODE={STOPHISTORYSNDS^RUN();VARITEMP0^SET($1);@IF(DBDIALOG^FIND("ID",ARRQUESTIONS^GET(VARITEMP0),0),"_","-1","BFITMP59","");SDIALOG^SET("DBDIALOG_CURSOR");VARSTEMP0^SET(["$WAVS\"+SDIALOG|QUE]);SNDQUESTION^LOAD(VARSTEMP0);SNDQUESTION^PLAY();}


OBJECT=BEHSPEAKQUESTIONHIST
BEHSPEAKQUESTIONHIST:TYPE=BEHAVIOUR
BEHSPEAKQUESTIONHIST:CODE={STOPHISTORYSNDS^RUN();VARITEMP0^SET($1);@IF(DBDIALOG^FIND("ID",ARRHISTORY^GET(VARITEMP0),0),"_","-1","BFITMP60","");SDIALOG^SET("DBDIALOG_CURSOR");VARSTEMP0^SET(["$WAVS\"+SDIALOG|QUE]);SNDQUESTION^LOAD(VARSTEMP0);SNDQUESTION^PLAY();}


OBJECT=STOPHISTORYSNDS
STOPHISTORYSNDS:TYPE=BEHAVIOUR
STOPHISTORYSNDS:CODE={SNDHISTORYENTER^STOP(FALSE);SNDHISTORYRETURN^STOP(FALSE);}


OBJECT=BEHHIDEALL
BEHHIDEALL:TYPE=BEHAVIOUR
BEHHIDEALL:CODE={@LOOP("{VARSTEMP0^SET(["ANNSMOKE_"+_I_]);*VARSTEMP0^HIDE();*VARSTEMP0^SETPOSITION(0,0);VARSTEMP0^SET(["ANNSMOKEHIST_"+_I_]);*VARSTEMP0^HIDE();*VARSTEMP0^SETPOSITION(0,0);}",0,24,1);}


OBJECT=BEHSAVE
BEHSAVE:TYPE=BEHAVIOUR
BEHSAVE:CODE={ARRHISTORY^SAVE(VARSCHARACTERHISTORY);ARRBASEQUESTIONS^SAVE(VARSREXQUE);ARRASKED^SAVE("$COMMON\QUESTIONS_ASKED0.ARR");}


OBJECT=BEHMMOVE
BEHMMOVE:TYPE=BEHAVIOUR
BEHMMOVE:CODE={VARSTEMP0^SET(CANVASOBSERVER^GETGRAPHICSAT(MOUSE^GETPOSX(),MOUSE^GETPOSY(),TRUE,15,15,TRUE));@IF("VARSFOCUS","_","VARSTEMP0","BFITMP63","BFITMP64");@IF(VARSTEMP0^FIND("SMOKE"),">","-1","BFITMP71","BFITMP72");}


OBJECT=_VOLUME_
_VOLUME_:TYPE=BEHAVIOUR
_VOLUME_:CODE={DIALOGS^SETMUSICVOLUME([0.8*G_ARRSETTINGS^GET(1)]);}


OBJECT=_NEWGAME_
_NEWGAME_:TYPE=BEHAVIOUR
_NEWGAME_:CODE={@IF(G_ARRDATAS^FIND(G_SARCADEOBJECTS),">","-1","BFITMP73","BFITMP74");}


OBJECT=_LOADGAME_
_LOADGAME_:TYPE=BEHAVIOUR
_LOADGAME_:CODE={@IF(G_ARRDATAS^FIND(G_SARCADEOBJECTS),">","-1","BFITMP75","BFITMP76");}


OBJECT=__HELPSTART__
__HELPSTART__:TYPE=BEHAVIOUR
__HELPSTART__:CODE={SCENENAME^SET(PRZYGODA^GETCURRENTSCENE());MOUSE^DISABLESIGNAL();__KEYB__^SET(KEYBOARD^ISENABLED());KEYBOARD^DISABLE();__HSPOTMAX__^SET(*SCENENAME^GETMAXHSPRIORITY());__HSPOTMIN__^SET(*SCENENAME^GETMINHSPRIORITY());*SCENENAME^GETPLAYINGANIMO("__GRHELP__");CNVLOADER^LOAD([G_SCUTSCENE+".CNV"]);}


OBJECT=__HELPEND__
__HELPEND__:TYPE=BEHAVIOUR
__HELPEND__:CODE={MOUSE^ENABLESIGNAL();KEYBOARD^ENABLE();CNVLOADER^RELEASE([G_SCUTSCENE+".CNV"]);}


OBJECT=BEHRETURN
BEHRETURN:TYPE=BEHAVIOUR
BEHRETURN:CODE={G_SLASTOBJECTS^SET("DIALOGS");G_SARCADEOBJECTS^SET(G_SDIALOGRETURN);PRZYGODA^GOTO("ARCADE");}


OBJECT=_CURSORMOVE_
_CURSORMOVE_:TYPE=BEHAVIOUR
_CURSORMOVE_:CODE={G_CURSOR^SETOBJECT(CANVASOBSERVER^GETGRAPHICSAT(MOUSE^GETPOSX(),MOUSE^GETPOSY(),TRUE,0,5000,TRUE));}


OBJECT=BEHFIXQUESTIONS
BEHFIXQUESTIONS:TYPE=BEHAVIOUR
BEHFIXQUESTIONS:CODE={VARITEMP0^SET(ARRBASEQUESTIONS^GETSIZE());VARITEMP0^DEC();@WHILE("VARITEMP0",">","-1","{VARSTEMP0^SET(ARRBASEQUESTIONS^GET(VARITEMP0));@IF(VARSTEMP0^LENGTH(),"<","1","BFITMP77","");VARITEMP0^DEC();}");}


OBJECT=BEHPLAYRANDOMKRET
BEHPLAYRANDOMKRET:TYPE=BEHAVIOUR
BEHPLAYRANDOMKRET:CODE={@IF("G_IKRETACTIVE",">","0","BFITMP78","");}


OBJECT=__PAUSESTART__
__PAUSESTART__:TYPE=BEHAVIOUR
__PAUSESTART__:CODE={SCENENAME^SET(PRZYGODA^GETCURRENTSCENE());MOUSE^DISABLESIGNAL();__KEYB__^SET(KEYBOARD^ISENABLED());KEYBOARD^DISABLE();__HSPOTMAX__^SET(*SCENENAME^GETMAXHSPRIORITY());__HSPOTMIN__^SET(*SCENENAME^GETMINHSPRIORITY());*SCENENAME^GETPLAYINGANIMO("__GRHELP__");}


OBJECT=__PAUSEEND__
__PAUSEEND__:TYPE=BEHAVIOUR
__PAUSEEND__:CODE={MOUSE^ENABLESIGNAL();KEYBOARD^ENABLE();__GRHELP__^REMOVEALL();}


OBJECT=BFITMP0
BFITMP0:TYPE=BEHAVIOUR
BFITMP0:CODE={@BREAK();}


OBJECT=BFITMP1
BFITMP1:TYPE=BEHAVIOUR
BFITMP1:CODE={@BREAK();}


OBJECT=BFITMP2
BFITMP2:TYPE=BEHAVIOUR
BFITMP2:CODE={@BREAK();}


OBJECT=BFITMP3
BFITMP3:TYPE=BEHAVIOUR
BFITMP3:CODE={VARIMODE^SET(1);BEHMAKESMOKESHIST^RUN();}


OBJECT=BFITMP4
BFITMP4:TYPE=BEHAVIOUR
BFITMP4:CODE={VARIMODE^SET(0);BEHMAKESMOKES^RUN();}


OBJECT=BFITMP5
BFITMP5:TYPE=BEHAVIOUR
BFITMP5:CODE={ARRHISTORY^ADD(ARRTOHISTORY^GET(0));}


OBJECT=BFITMP6
BFITMP6:TYPE=BEHAVIOUR
BFITMP6:CODE={ARRASKED^ADD(ARRTOASKED^GET(0));}


OBJECT=BFITMP7
BFITMP7:TYPE=BEHAVIOUR
BFITMP7:CODE={ARRBASEQUESTIONS^REMOVEAT(ARRTOREMOVE^GET(0));}


OBJECT=BFITMP8
BFITMP8:TYPE=BEHAVIOUR
BFITMP8:CODE={PRZYGODA^GOTO("CHOICE");@BREAK();}


OBJECT=BFITMP9
BFITMP9:TYPE=BEHAVIOUR
BFITMP9:CODE={G_SARCADEOBJECTS^SET("0");PRZYGODA^GOTO("DRAGON");@BREAK();}


OBJECT=BFITMP10
BFITMP10:TYPE=BEHAVIOUR
BFITMP10:CODE={G_SARCADEOBJECTS^SET("3");PRZYGODA^GOTO("DRAGON");@BREAK();}


OBJECT=BFITMP11
BFITMP11:TYPE=BEHAVIOUR
BFITMP11:CODE={G_SLASTOBJECTS^SET("DIALOGS");G_SARCADEOBJECTS^SET("PODWIECZOREK3");PRZYGODA^GOTO("ARCADE");@BREAK();}


OBJECT=BFITMP12
BFITMP12:TYPE=BEHAVIOUR
BFITMP12:CODE={@IF(ARRTOHISTORY^GETSIZE(),">","0","BFITMP5","");@IF(ARRTOASKED^GETSIZE(),">","0","BFITMP6","");@IF(ARRTOREMOVE^GETSIZE(),">","0","BFITMP7","");@LOOP("{VARITEMP0^SET(_I_);ARRBASEQUESTIONS^ADD(ARRTOTRIGGER^GET(VARITEMP0));}",0,ARRTOTRIGGER^GETSIZE(),1);ARRTOHISTORY^REMOVEALL();ARRTOASKED^REMOVEALL();ARRTOREMOVE^REMOVEALL();ARRTOTRIGGER^REMOVEALL();BEHBUILDQUESTIONS^RUN();BEHMAKESMOKES^RUN();BEHFIXQUESTIONS^RUN();BEHBUILDQUESTIONS^RUN();BEHSAVE^RUN();@IF("VARSCURRID","_",""12"","BFITMP8","");@IF("VARSCURRID","_",""42B"","BFITMP9","");@IF("VARSCURRID'"43A"||VARSCURRID'"43B"","BFITMP10","");@IF("VARSCURRID","_",""112"","BFITMP11","");BEHPLAYRANDOMKRET^RUN();}


OBJECT=BFITMP13
BFITMP13:TYPE=BEHAVIOUR
BFITMP13:CODE={SNDANSWER^STOP(FALSE);SEQBLANK^STOP(FALSE);SNDANSWER^LOAD(ARRSEQ^GET(0));ARRSEQ^REMOVEAT(0);SEQBLANK^PLAY("GADABLANK");}


OBJECT=BFITMP14
BFITMP14:TYPE=BEHAVIOUR
BFITMP14:CODE={@IF("VARIMODE","_","0","BFITMP12","");}


OBJECT=BFITMP15
BFITMP15:TYPE=BEHAVIOUR
BFITMP15:CODE={@BREAK();}


OBJECT=BFITMP16
BFITMP16:TYPE=BEHAVIOUR
BFITMP16:CODE={@BREAK();}


OBJECT=BFITMP17
BFITMP17:TYPE=BEHAVIOUR
BFITMP17:CODE={@BREAK();}


OBJECT=BFITMP18
BFITMP18:TYPE=BEHAVIOUR
BFITMP18:CODE={VARSTEMP0^SUB(0,9);}


OBJECT=BFITMP19
BFITMP19:TYPE=BEHAVIOUR
BFITMP19:CODE={VARSTEMP0^SUB(0,13);}


OBJECT=BFITMP20
BFITMP20:TYPE=BEHAVIOUR
BFITMP20:CODE={VARITEMP0^SET(0);}


OBJECT=BFITMP21
BFITMP21:TYPE=BEHAVIOUR
BFITMP21:CODE={@IF("VARIMODE","_","0","BFITMP18","BFITMP19");VARITEMP0^SET(VARSTEMP0);}


OBJECT=BFITMP22
BFITMP22:TYPE=BEHAVIOUR
BFITMP22:CODE={BEHASK^RUN(VARSTEMP0);VARSFOCUS^SET("NULL");VARIFOCUSIDX^SET(-1);}


OBJECT=BFITMP23
BFITMP23:TYPE=BEHAVIOUR
BFITMP23:CODE={BEHASKHISTORY^RUN(VARITEMP0);}


OBJECT=BFITMP24
BFITMP24:TYPE=BEHAVIOUR
BFITMP24:CODE={@IF(VARSTEMP0^FIND("_"),"_","-1","BFITMP20","BFITMP21");@IF("VARIMODE","_","0","BFITMP22","BFITMP23");}


OBJECT=BFITMP25
BFITMP25:TYPE=BEHAVIOUR
BFITMP25:CODE={@BREAK();}


OBJECT=BFITMP26
BFITMP26:TYPE=BEHAVIOUR
BFITMP26:CODE={@BREAK();}


OBJECT=BFITMP27
BFITMP27:TYPE=BEHAVIOUR
BFITMP27:CODE={@BREAK();}


OBJECT=BFITMP28
BFITMP28:TYPE=BEHAVIOUR
BFITMP28:CODE={ANNHISTORY^HIDE();}


OBJECT=BFITMP29
BFITMP29:TYPE=BEHAVIOUR
BFITMP29:CODE={ANNHISTORY^SETASBUTTON(TRUE,TRUE);}


OBJECT=BFITMP30
BFITMP30:TYPE=BEHAVIOUR
BFITMP30:CODE={ARRTOTRIGGER^ADD(VARSTEMP0);}


OBJECT=BFITMP31
BFITMP31:TYPE=BEHAVIOUR
BFITMP31:CODE={ARRTOTRIGGER^ADD(VARSTEMP1);}


OBJECT=BFITMP32
BFITMP32:TYPE=BEHAVIOUR
BFITMP32:CODE={@IF("ARRBASEQUESTIONS^FIND(VARSTEMP0)'-1&&ARRASKED^FIND(VARSTEMP0)'-1","BFITMP30","");VARSTEMP0^SET("");VARITEMP1^SET(0);}


OBJECT=BFITMP33
BFITMP33:TYPE=BEHAVIOUR
BFITMP33:CODE={VARSTEMP1^SET(VARSTEMP0);VARSTEMP1^SUB(VARITEMP0,[VARSTEMP1^LENGTH()-VARITEMP0]);@IF("ARRBASEQUESTIONS^FIND(VARSTEMP1)'-1&&ARRASKED^FIND(VARSTEMP0)'-1","BFITMP31","");VARSTEMP0^SUB(0,[VARITEMP0+1]);VARITEMP1^SET(10);}


OBJECT=BFITMP34
BFITMP34:TYPE=BEHAVIOUR
BFITMP34:CODE={VARITEMP1^SET(VARSTEMP0^LENGTH());@WHILE("VARITEMP1",">","0","{VARITEMP0^SET(VARSTEMP0^FIND("_"));@IF("VARITEMP0","_","-1","BFITMP32","BFITMP33");}");}


OBJECT=BFITMP35
BFITMP35:TYPE=BEHAVIOUR
BFITMP35:CODE={ARRQUESTIONS^ADD(ARRBASEQUESTIONS^GET(VARITEMP0));}


OBJECT=BFITMP36
BFITMP36:TYPE=BEHAVIOUR
BFITMP36:CODE={@BREAK();}


OBJECT=BFITMP37
BFITMP37:TYPE=BEHAVIOUR
BFITMP37:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP38
BFITMP38:TYPE=BEHAVIOUR
BFITMP38:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP39
BFITMP39:TYPE=BEHAVIOUR
BFITMP39:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP40
BFITMP40:TYPE=BEHAVIOUR
BFITMP40:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP41
BFITMP41:TYPE=BEHAVIOUR
BFITMP41:CODE={VARITEMP0^SET(ARRBASEQUESTIONS^FIND("97"));@IF("VARITEMP0",">","-1","BFITMP37","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("98"));@IF("VARITEMP0",">","-1","BFITMP38","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("99"));@IF("VARITEMP0",">","-1","BFITMP39","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("100"));@IF("VARITEMP0",">","-1","BFITMP40","");}


OBJECT=BFITMP42
BFITMP42:TYPE=BEHAVIOUR
BFITMP42:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP43
BFITMP43:TYPE=BEHAVIOUR
BFITMP43:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP44
BFITMP44:TYPE=BEHAVIOUR
BFITMP44:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP45
BFITMP45:TYPE=BEHAVIOUR
BFITMP45:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP46
BFITMP46:TYPE=BEHAVIOUR
BFITMP46:CODE={VARITEMP0^SET(ARRBASEQUESTIONS^FIND("102"));@IF("VARITEMP0",">","-1","BFITMP42","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("103"));@IF("VARITEMP0",">","-1","BFITMP43","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("105"));@IF("VARITEMP0",">","-1","BFITMP44","");VARITEMP0^SET(ARRBASEQUESTIONS^FIND("106"));@IF("VARITEMP0",">","-1","BFITMP45","");}


OBJECT=BFITMP47
BFITMP47:TYPE=BEHAVIOUR
BFITMP47:CODE={ARRTOHISTORY^REMOVEALL();ARRTOHISTORY^ADD(SDIALOG|ID);ARRTOASKED^REMOVEALL();ARRTOASKED^ADD(SDIALOG|ID);}


OBJECT=BFITMP48
BFITMP48:TYPE=BEHAVIOUR
BFITMP48:CODE={@IF("VARSCURRID","!_",""12"","BFITMP47","");ARRTOREMOVE^REMOVEALL();ARRTOREMOVE^ADD(VARITEMP1);}


OBJECT=BFITMP49
BFITMP49:TYPE=BEHAVIOUR
BFITMP49:CODE={@BREAK();}


OBJECT=BFITMP50
BFITMP50:TYPE=BEHAVIOUR
BFITMP50:CODE={@BREAK();}


OBJECT=BFITMP51
BFITMP51:TYPE=BEHAVIOUR
BFITMP51:CODE={G_MENU^ADDEXP(30);}


OBJECT=BFITMP52
BFITMP52:TYPE=BEHAVIOUR
BFITMP52:CODE={@IF("VARIMODE","_","0","BFITMP51","");VARSTEMP1^SET(G_CARD^GETHINT(VARICHARACTERINDEX));G_CARD^ACTIVATEWIZARD(VARICHARACTERINDEX);}


OBJECT=BFITMP53
BFITMP53:TYPE=BEHAVIOUR
BFITMP53:CODE={VARSTEMP1^SET(["$WAVS\"+VARSTEMP1+".WAV"]);}


OBJECT=BFITMP54
BFITMP54:TYPE=BEHAVIOUR
BFITMP54:CODE={VARSTEMP0^SUB(0,1);}


OBJECT=BFITMP55
BFITMP55:TYPE=BEHAVIOUR
BFITMP55:CODE={VARSTEMP0^SET("");VARITEMP1^SET(0);}


OBJECT=BFITMP56
BFITMP56:TYPE=BEHAVIOUR
BFITMP56:CODE={VARSTEMP1^SET(VARSTEMP0);VARSTEMP1^SUB(VARITEMP0,[VARSTEMP0^LENGTH()-VARITEMP0]);@IF("VARSTEMP1'"HINT"&&VARICHARACTERINDEX>-1","BFITMP52","BFITMP53");ARRSEQ^ADD(VARSTEMP1);VARSTEMP0^SUB(0,[VARITEMP0+4]);VARITEMP1^SET(VARSTEMP0^LENGTH());@IF("VARITEMP1",">","0","BFITMP54","");}


OBJECT=BFITMP57
BFITMP57:TYPE=BEHAVIOUR
BFITMP57:CODE={VARITEMP0^SET(0);VARITEMP1^INC();}


OBJECT=BFITMP58
BFITMP58:TYPE=BEHAVIOUR
BFITMP58:CODE={VARITEMP0^SET(0);VARITEMP1^INC();}


OBJECT=BFITMP59
BFITMP59:TYPE=BEHAVIOUR
BFITMP59:CODE={@BREAK();}


OBJECT=BFITMP60
BFITMP60:TYPE=BEHAVIOUR
BFITMP60:CODE={@BREAK();}


OBJECT=BFITMP61
BFITMP61:TYPE=BEHAVIOUR
BFITMP61:CODE={VARSTEMP1^SET(["PLAY"+VARIFOCUSIDX]);*VARSFOCUS^PLAY(VARSTEMP1);}


OBJECT=BFITMP62
BFITMP62:TYPE=BEHAVIOUR
BFITMP62:CODE={*VARSFOCUS^PLAY("PLAY");}


OBJECT=BFITMP63
BFITMP63:TYPE=BEHAVIOUR
BFITMP63:CODE={@BREAK();}


OBJECT=BFITMP64
BFITMP64:TYPE=BEHAVIOUR
BFITMP64:CODE={@IF("VARIFOCUSIDX",">","-1","BFITMP61","");@IF("VARIFOCUSIDX","_","-2","BFITMP62","");VARSFOCUS^SET(VARSTEMP0);}


OBJECT=BFITMP65
BFITMP65:TYPE=BEHAVIOUR
BFITMP65:CODE={VARITEMP0^SET(0);}


OBJECT=BFITMP66
BFITMP66:TYPE=BEHAVIOUR
BFITMP66:CODE={VARSTEMP0^SUB(0,9);VARITEMP0^SET(VARSTEMP0);}


OBJECT=BFITMP67
BFITMP67:TYPE=BEHAVIOUR
BFITMP67:CODE={VARITEMP0^SET(0);}


OBJECT=BFITMP68
BFITMP68:TYPE=BEHAVIOUR
BFITMP68:CODE={VARSTEMP0^SUB(0,13);VARITEMP0^SET(VARSTEMP0);}


OBJECT=BFITMP69
BFITMP69:TYPE=BEHAVIOUR
BFITMP69:CODE={VARSTEMP1^SET(*VARSTEMP0^GETEVENTNAME());VARSTEMP1^SUB(0,4);VARIFOCUSIDX^SET(VARSTEMP1);*VARSFOCUS^PLAY(["GADA"+VARIFOCUSIDX]);@IF(VARSTEMP0^FIND("_"),"_","-1","BFITMP65","BFITMP66");BEHSPEAKQUESTION^RUN(VARITEMP0);}


OBJECT=BFITMP70
BFITMP70:TYPE=BEHAVIOUR
BFITMP70:CODE={*VARSTEMP0^PLAY("GADA");@IF(VARSTEMP0^FIND("_"),"_","-1","BFITMP67","BFITMP68");VARIFOCUSIDX^SET(-2);BEHSPEAKQUESTIONHIST^RUN(VARITEMP0);}


OBJECT=BFITMP71
BFITMP71:TYPE=BEHAVIOUR
BFITMP71:CODE={@IF("VARIMODE","_","0","BFITMP69","BFITMP70");}


OBJECT=BFITMP72
BFITMP72:TYPE=BEHAVIOUR
BFITMP72:CODE={VARIFOCUSIDX^SET(-1);}


OBJECT=BFITMP73
BFITMP73:TYPE=BEHAVIOUR
BFITMP73:CODE={PRZYGODA^GOTO("ARCADE");@BREAK();}


OBJECT=BFITMP74
BFITMP74:TYPE=BEHAVIOUR
BFITMP74:CODE={PRZYGODA^GOTO(G_SARCADEOBJECTS);@BREAK();}


OBJECT=BFITMP75
BFITMP75:TYPE=BEHAVIOUR
BFITMP75:CODE={PRZYGODA^GOTO("ARCADE");@BREAK();}


OBJECT=BFITMP76
BFITMP76:TYPE=BEHAVIOUR
BFITMP76:CODE={PRZYGODA^GOTO(G_SARCADEOBJECTS);@BREAK();}


OBJECT=BFITMP77
BFITMP77:TYPE=BEHAVIOUR
BFITMP77:CODE={ARRBASEQUESTIONS^REMOVEAT(VARITEMP0);}


OBJECT=BFITMP78
BFITMP78:TYPE=BEHAVIOUR
BFITMP78:CODE={VARITEMP0^SET(RANDOM^GET(0,10));VARSTEMP0^SET(["SNDKRET"+VARITEMP0]);*VARSTEMP0^PLAY();}


